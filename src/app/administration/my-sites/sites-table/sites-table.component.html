<div class="dash-board-content-area-wrappper mt--30 mt_sm--0 mt_md--0">

    <div
        class="single-card-dashboard account-info box-dashboard-dashboard d-flex align-items-center justify-content-between">
        <h3 class="title title-top-primary"><i class="fa-regular fa-building"></i>My Sites</h3>
        <a routerLink="../add-site" class="tmp-btn btn-primary hover-icon-reverse btn-sm">
            <span class="icon-reverse-wrapper">
                <span class="btn-text">Add New Site</span>
                <span class="btn-icon"><i class="fa-solid fa-add"></i></span>
                <span class="btn-icon"><i class="fa-solid fa-add"></i></span>
            </span>
        </a>
    </div>
    <div class="single-card-dashboard account-info box-dashboard-dashboard">

        <!-- Search Bar -->
        <div class="mb-4">
            <div class="d-flex align-items-center gap-2"
                style="border: 1px solid #dee2e6; border-radius: 8px; padding: 8px 16px; max-width: 400px;">
                <i class="fa-solid fa-magnifying-glass" style="color: #999;"></i>
                <input type="text" [(ngModel)]="searchQuery" placeholder="Search sites..."
                    style="border: none; outline: none; width: 100%; font-size: 14px;">
            </div>
        </div>

        <div class="invers-dashboard-table table-responsive mobile-table-750">
            <table class="invers-table table table-borderless">
                <thead>
                    <tr>
                        <th>Site Name</th>
                        <th>Site Type</th>
                        <th>Location</th>
                        <th>Budget</th>
                        <th>Advance</th>
                        <th>Remaining</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngFor="let site of filteredSites; let i = index">
                        <th>{{ site.name }}</th>
                        <th>{{ site.type }}</th>
                        <th>{{ site.location }}</th>
                        <td>{{ site.total_budget | number }}</td>
                        <td>{{ site.advance_received | number }}</td>
                        <td>{{ site.remaining_balance | number }}</td>
                        <td>
                            <span class="invers-badge-minimal" [ngClass]="{
                                    'success': site.status === 'Completed',
                                    'color-warning': site.status === 'Pending' || site.status === 'On Hold',
                                    'color-danger': site.status === 'Dispute',
                                    'primary': site.status === 'Ongoing'
                                }">
                                {{ site.status }}
                            </span>
                        </td>
                        <td>
                            <div class="d-flex gap-3">
                                <a role="button" class="text-primary" [routerLink]="['../edit-site', site.id]"><i
                                        class="fa-regular fa-pen-to-square"></i>Edit</a>
                                <a role="button" class="text-danger" (click)="deleteSite(site.id)"><i
                                        class="fa-regular fa-trash-can"></i>Delete</a>
                            </div>
                        </td>
                    </tr>
                    <tr *ngIf="filteredSites.length === 0 && !loading">
                        <td colspan="8" class="text-center py-4" style="color: #999;">
                            <i class="fa-solid fa-search" style="font-size: 24px;"></i>
                            <p class="mt-2 mb-0">No sites found matching "{{ searchQuery }}"</p>
                        </td>
                    </tr>
                    <tr *ngIf="loading">
                        <td colspan="8" class="text-center">Loading...</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

</div>